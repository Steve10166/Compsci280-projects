<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CS280 — Project 3: Image Warping & Mosaicing</title>
  <style>
    :root{
      --bg:#f9f9f9; --text:#333; --muted:#666;
      --brand:#16a085; --brandDark:#0f7c67; --head:#2c3e50;
      --card:#fff; --shadow:0 2px 8px rgba(0,0,0,.12);
      --border:#eee;
    }
    *{box-sizing:border-box}
    body{font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:var(--text);margin:0}
    a{color:var(--brandDark);text-decoration:none}
    a:hover{text-decoration:underline}
    header{padding:28px 20px 10px}
    .wrap{max-width:1100px;margin:0 auto;padding:0 20px 40px}
    h1{color:var(--head);margin:0 0 6px}
    .sub{color:var(--muted);margin:0 0 18px}
    .toolbar{display:flex;gap:10px;flex-wrap:wrap;margin:8px 0 18px}
    .btn{display:inline-block;background:var(--card);border:1px solid var(--border);padding:10px 14px;border-radius:12px;box-shadow:var(--shadow);font-weight:600;color:var(--head)}
    .btn:hover{transform:translateY(-1px);box-shadow:0 6px 14px rgba(0,0,0,.12)}
    section{background:var(--card);box-shadow:var(--shadow);border-radius:14px;padding:22px;margin:18px 0}
    h2{color:var(--brand);margin:0 0 12px}
    h3{color:var(--head);margin:18px 0 8px}
    p{line-height:1.65}
    .grid{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));margin-top:8px}
    figure{margin:0;background:#fff;border:1px solid var(--border);border-radius:10px;overflow:hidden;box-shadow:var(--shadow)}
    figure img{width:100%;height:auto;display:block}
    figcaption{padding:8px 10px;font-size:.92rem;color:var(--muted)}
    details{background:#fafafa;border:1px solid var(--border);border-radius:10px;padding:12px 14px}
    details>summary{font-weight:600;color:var(--head);cursor:pointer;margin:-4px 0 8px}
    .note{font-size:.92rem;color:var(--muted)}
    code.kbd{background:#f1f1f1;border:1px solid #e5e5e5;padding:2px 6px;border-radius:6px}
    table{width:100%;border-collapse:collapse;margin-top:10px}
    th,td{border:1px solid #e6e6e6;padding:8px 10px;text-align:left;font-size:.95rem}
    th{background:#fbfbfb}
    .toc{display:flex;flex-wrap:wrap;gap:8px}
    .toc a{background:#fff;border:1px solid var(--border);padding:6px 10px;border-radius:999px}
  </style>
</head>
<body>
  <header class="wrap">
    <h1>Project 3 — Image Warping &amp; Mosaicing</h1>
    <p class="sub">First part of a larger project: homographies, warping, resampling, and blending.</p>
  </header>

  <main class="wrap">
    <section id="overview">
      <h2>Overview</h2>
      <p>
        The goal is to register two or more photos and create a mosaic by computing homographies,
        warping with inverse mapping (nearest &amp; bilinear), and compositing with feathered blending.
        I also explore cylindrical/spherical mappings for wide panoramas.
      </p>
      <div id="toc" class="toc" aria-label="Table of contents">
        <a href="#a1">A.1 Shoot &amp; Digitize</a>
        <a href="#a2">A.2 Recover Homographies</a>
        <a href="#a3">A.3 Warp Images</a>
        <a href="#a4">A.4 Blend into Mosaic</a>
        <a href="#a5">A.5 Bells &amp; Whistles</a>
        <a href="#extras">Ungraded Extensions</a>
      </div>
    </section>

    <!-- A.1 -->
    <section id="a1">
      <h2>A.1 — Shoot and Digitize Pictures (20 pts)</h2>
      <p class="note">
        Fixed center of projection, rotate camera; 40–70% overlap; avoid heavy distortion lenses when possible.
      </p>
      <div class="grid">
        <figure><img src="proj3/imgs/set1/IMG_0815.jpeg"</figure>
        <figure><img src="proj3/imgs/set1/IMG_0816.jpeg"</figure>
        <figure><img src="proj3/imgs/set1/IMG_0817.jpeg"</figure>
        <figure><img src="proj3/imgs/set1/IMG_0818.jpeg"</figure>
        <figure><img src="proj3/imgs/set1/IMG_0819.jpeg"</figure>
        <figure><img src="proj3/imgs/set1/IMG_0820.jpeg"</figure>
      </div>
      <div class="grid">
        <figure><img src="proj3/imgs/set2/IMG_0824.jpeg"</figure>
        <figure><img src="proj3/imgs/set2/IMG_0825.jpeg"</figure>
        <figure><img src="proj3/imgs/set2/IMG_0826.jpeg"</figure>
        <figure><img src="proj3/imgs/set2/IMG_0827.jpeg"</figure>
        <figure><img src="proj3/imgs/set2/IMG_0828.jpeg"</figure>
        <figure><img src="proj3/imgs/set2/IMG_0829.jpeg"</figure>
      </div>
    </section>

    <!-- A.2 -->
    <section id="a2">
      <h2>A.2 — Recover Homographies (20 pts)</h2>
      <p>
        I collect <code>n≥4</code> point correspondences with a ginput tool and solve for the
        projective transform <code>p' = H p</code> using least squares on the linearized system.
      </p>
      <details>
        <summary>Correspondence Visualizations</summary>
        <div class="grid">
          <figure><img src="project3/corr/set1_pairs.png" alt="Set 1 correspondences"><figcaption>Set 1 matches</figcaption></figure>
          <figure><img src="project3/corr/set2_pairs.png" alt="Set 2 correspondences"><figcaption>Set 2 matches</figcaption></figure>
        </div>
      </details>
      <details>
        <summary>Recovered Homography Matrices</summary>
        <table>
          <thead><tr><th>Pair</th><th>H (3×3)</th></tr></thead>
          <tbody>
            <tr>
              <td>Set 1 (2→1)</td>
              <td><code>[h11 h12 h13; h21 h22 h23; h31 h32 h33]</code></td>
            </tr>
            <tr>
              <td>Set 2 (2→1)</td>
              <td><code>[...]</code></td>
            </tr>
          </tbody>
        </table>
      </details>
    </section>

    <!-- A.3 -->
    <section id="a3">
      <h2>A.3 — Warp the Images (20 pts)</h2>
      <p>
        I implement <b>inverse warping</b> with two interpolation methods:
        <code>warpImageNearestNeighbor(im,H)</code> and <code>warpImageBilinear(im,H)</code>.
        I also perform planar rectification by mapping a clicked quadrilateral to a square.
      </p>
      <h3>Rectification Examples</h3>
      <div class="grid">
        <figure><img src="project3/rectify/poster_src.jpg" alt="Poster source"><figcaption>Source with planar target</figcaption></figure>
        <figure><img src="project3/rectify/poster_rectified_nn.jpg" alt="Rectified NN"><figcaption>Rectified (Nearest)</figcaption></figure>
        <figure><img src="project3/rectify/poster_rectified_bil.jpg" alt="Rectified Bilinear"><figcaption>Rectified (Bilinear)</figcaption></figure>
      </div>
      <p class="note">Nearest is faster but jaggier; bilinear is smoother, better for mosaics.</p>
    </section>

    <!-- A.4 -->
    <section id="a4">
      <h2>A.4 — Blend the Images into a Mosaic (20 pts)</h2>
      <p>
        After warping into a common frame, I composite with alpha feathering / weighted averaging.
        The canvas expands dynamically to fit each new layer.
      </p>
      <h3>Mosaic Results (3+)</h3>
      <div class="grid">
        <figure><img src="project3/mosaic/set1_sources.png" alt="Set 1 sources"><figcaption>Set 1 — sources</figcaption></figure>
        <figure><img src="project3/mosaic/set1_mosaic.png" alt="Set 1 mosaic"><figcaption>Set 1 — mosaic</figcaption></figure>

        <figure><img src="project3/mosaic/set2_sources.png" alt="Set 2 sources"><figcaption>Set 2 — sources</figcaption></figure>
        <figure><img src="project3/mosaic/set2_mosaic.png" alt="Set 2 mosaic"><figcaption>Set 2 — mosaic</figcaption></figure>

        <figure><img src="project3/mosaic/set3_sources.png" alt="Set 3 sources"><figcaption>Set 3 — sources</figcaption></figure>
        <figure><img src="project3/mosaic/set3_mosaic.png" alt="Set 3 mosaic"><figcaption>Set 3 — mosaic</figcaption></figure>
      </div>
      <details>
        <summary>Blending Notes</summary>
        <p class="note">
          I use per-pixel alpha and simple feathering. For strong seams, a 2-level Laplacian blend helps
          reduce ghosting of high-frequency edges.
        </p>
      </details>
    </section>

    <!-- A.5 -->
    <section id="a5">
      <h2>A.5 — Bells &amp; Whistles (Mandatory for CS280A)</h2>
      <p>
        I implemented <b>cylindrical</b> (and optional spherical) pre-warping for wide panoramas.
        Images are first mapped to the cylindrical surface using a focal length (or FOV), then stitched
        in cylindrical coordinates.
      </p>
      <div class="grid">
        <figure><img src="project3/cyl/cyl_sources.png" alt="Cylindrical inputs"><figcaption>Inputs (rotational sweep)</figcaption></figure>
        <figure><img src="project3/cyl/cyl_panorama.png" alt="Cyl panorama"><figcaption>Cylindrical panorama (concave)</figcaption></figure>
      </div>
      <details>
        <summary>Implementation Highlights</summary>
        <ul>
          <li>Inverse map: for output (X<sub>c</sub>, Y<sub>c</sub>) on cylinder, back-project to source (x, y) and sample bilinearly.</li>
          <li>Concave vs. convex in image coords: flip the sign on the vertical term when y-axis points downward.</li>
          <li>Consistent focal length across frames to keep scale stable; I expose <code>f</code> or <code>FOV°</code>.</li>
        </ul>
      </details>
    </section>

    <!-- Extras -->
    <section id="extras">
      <h2>Ungraded Extensions</h2>
      <ul>
        <li><b>Rotation-only model</b> for pure yaw sweeps (estimate focal length).</li>
        <li><b>360° cylindrical panorama</b> with translation-only stitching after cylindrical warp.</li>
        <li><b>Video mosaics</b> with frame-wise homographies and feathered temporal blending.</li>
      </ul>
    </section>

    <section>
      <h2>Files &amp; Repo Notes</h2>
      <ul>
        <li>Code: <code class="kbd">proj3/</code> (homography, warps, cylindrical, blending)</li>
        <li>Data: <code class="kbd">project3/data/</code></li>
        <li>Outputs: <code class="kbd">project3/mosaic/</code>, <code class="kbd">project3/rectify/</code>, <code class="kbd">project3/cyl/</code></li>
      </ul>
    </section>
  </main>
</body>
</html>